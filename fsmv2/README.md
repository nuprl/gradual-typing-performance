Version 2 of finite-state-machine 
